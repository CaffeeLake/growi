#1 [internal] load build definition from Dockerfile
#1 sha256:6670b03e69b677e672500d407de20be68d287531d3ca56a027b57acd405249f7
#1 transferring dockerfile: 3.71kB 0.0s done
#1 DONE 0.1s

#2 [internal] load .dockerignore
#2 sha256:6fddf26f44342a18207998ee437aaad7b480fb505897a346f9e670ff7682b1b6
#2 transferring context:
#2 transferring context: 2B 0.1s done
#2 DONE 0.2s

#3 resolve image config for docker.io/docker/dockerfile:1.4
#3 sha256:4c6393aa7d63350bb37611567d30ae32494404c0b27cf79a51e51112ce252eca
#3 ...

#4 [auth] docker/dockerfile:pull token for registry-1.docker.io
#4 sha256:72cfa024ccb545775db58492bef3c4661f96a238bd5ae0ddb22fcc7e0712060e
#4 DONE 0.0s

#3 resolve image config for docker.io/docker/dockerfile:1.4
#3 sha256:4c6393aa7d63350bb37611567d30ae32494404c0b27cf79a51e51112ce252eca
#3 DONE 2.5s

#5 docker-image://docker.io/docker/dockerfile:1.4@sha256:9ba7531bd80fb0a858632727cf7a112fbfd19b17e94c4e84ced81e24ef1a0dbc
#5 sha256:f8ced039b92255abe2a5d9b1b282755057c6783a74e367c16ca94e7b53ed923b
#5 CACHED

#6 [internal] load .dockerignore
#6 sha256:46d48cd8f9a716b8fb4fe20109c29fcf8a965dcacc1c2d0261fb9cbbfdb569b4
#6 DONE 0.0s

#7 [internal] load build definition from Dockerfile
#7 sha256:6598bb63aa5b58afbd4b5635ca7aff7f214f0857ed2c5d018d514089d004babd
#7 DONE 0.0s

#8 [internal] load metadata for docker.io/library/node:16-slim
#8 sha256:faa605aa367b596b57bbdc1bdcccade69c92d97d03d44e595a34c7e28b8d594e
#8 ...

#9 [auth] library/node:pull token for registry-1.docker.io
#9 sha256:a43c9eb5063e7e309182302285fc2505fc9a9318e27c630703493edc208457b3
#9 DONE 0.0s

#8 [internal] load metadata for docker.io/library/node:16-slim
#8 sha256:faa605aa367b596b57bbdc1bdcccade69c92d97d03d44e595a34c7e28b8d594e
#8 DONE 1.3s

#10 [prebuilder-default 1/5] FROM docker.io/library/node:16-slim@sha256:197c40ee61039103188b3a96046fb8c90fdf09b60f44c22a080bbe70b87c8a6f
#10 sha256:d1d1f4c52c5f1faac7db94e31744f12556bc87d80924f1a777d8a0f63bb81be1
#10 DONE 0.0s

#13 [internal] load build context
#13 sha256:faf056494d7122c0f3699f1d8aca653270e009066d6e3e7c0ffe946cea0c3d5a
#13 transferring context: 53.69kB 0.1s
#13 transferring context: 1.56MB 0.7s done
#13 DONE 0.9s

#12 [prebuilder-default 2/5] WORKDIR /opt
#12 sha256:cd2c4142890bfdf8c2eca5ac6e7056e8f29113b3dc4fe85532a1118c3c49a379
#12 CACHED

#14 [packages-json-picker 3/5] COPY [package.json, yarn.lock, lerna.json, ./]
#14 sha256:75e32c6cba9a62e6d8a9dca0c0faa0cd3816f9b8df2ab303034341b994d1f273
#14 CACHED

#15 [packages-json-picker 4/5] COPY packages packages
#15 sha256:f7d93b451dff41ef37417346c6ea674faadf21d9958ebb5f32318de43f94ba18
#15 DONE 14.7s

#16 [packages-json-picker 5/5] RUN find packages ! -name "package.json" -mindepth 2 -maxdepth 2 -print | xargs rm -rf
#16 sha256:48db438b72b3044214c840779331403a916a147bdd01689e7f5e83baebf9d9db
#16 DONE 1.4s

#19 [deps-resolver 5/7] RUN npx -y lerna bootstrap -- --frozen-lockfile
#19 sha256:2fa2acc67fbfe3cd9da48e11eb83886b932af9dd79c0681c3d63882ac3166744
#19 CACHED

#28 [prebuilder-default 5/5] RUN rm node_modules.tar
#28 sha256:64293897486a3d2b345a76d68b82a69a62deb4e6dbd1fd2b0c19d62ffa8fa3d3
#28 CACHED

#20 [deps-resolver 6/7] RUN rm -f $(echo /opt/node_modules/@growi/slackbot-proxy | sed -e "s/,/ /g")
#20 sha256:2bf9b68fcd912b492d0ce14d11438cdb9744c3fef8972bdf0bac7ca5fd349037
#20 CACHED

#17 [deps-resolver 3/7] COPY --from=packages-json-picker /opt .
#17 sha256:5ec74510650591cb77491fa35857ee8a8a230a79a1a03aee5a7fc899e4b3c220
#17 CACHED

#27 [prebuilder-default 4/5] RUN tar -xf node_modules.tar
#27 sha256:355f2fc7a9df86cb492f1cc946a29c071bdc3afc7370296058606fe24f57d4f5
#27 CACHED

#29 [builder  1/13] WORKDIR /opt
#29 sha256:959e9fb73c5b89da746a7651b5f7f3794febf59e9fc4ac1bb01a6d73606ac13a
#29 CACHED

#21 [deps-resolver 7/7] RUN tar -cf node_modules.tar   node_modules   packages/*/node_modules
#21 sha256:d61f189d80beec1baa5a5afa937c411d1ce48aa6552b1046af09781518cb9925
#21 CACHED

#18 [deps-resolver 4/7] RUN yarn config set network-timeout 300000
#18 sha256:3f8859d22050b76bea3d47bc243a93f354787842c413cb357094a51c6595ed6a
#18 CACHED

#26 [prebuilder-default 3/5] COPY --from=deps-resolver   /opt/node_modules.tar /opt/
#26 sha256:63eef4970e14ca50fb991835188854e8d520c40dbc3f660064325323ed7e48d9
#26 CACHED

#30 [builder  2/13] COPY [package.json, lerna.json, tsconfig.base.json, ./]
#30 sha256:6ffa8ca501c8e735ce9692ad7bba09104f5b57ea25a9167ca5e40f92050d6865
#30 CACHED

#31 [builder  3/13] COPY packages/app packages/app
#31 sha256:752d386416a4c8c5b74f17925d95a165ce52e7c06a202a470b4b2186137e110f
#31 DONE 18.7s

#32 [builder  4/13] COPY packages/core packages/core
#32 sha256:bb38a6dac0dacdca6dde88c3d45ffc4497120a9a19fec28db85c33c4b73807f7
#32 DONE 0.2s

#33 [builder  5/13] COPY packages/codemirror-textlint packages/codemirror-textlint
#33 sha256:0fbc5ea536cafb8a7a7db5931f24e08e28bfaf743b1301c6ce398961a950b620
#33 DONE 0.0s

#34 [builder  6/13] COPY packages/slack packages/slack
#34 sha256:deac33baa8e00c7259c0ccfa80b80a451f5000f5fd42ba0d4335b83b29154e1c
#34 DONE 0.1s

#35 [builder  7/13] COPY packages/ui packages/ui
#35 sha256:2c34492379abe4202bb231f9c8f936312e046c64059898a65a06c3972af1c5c4
#35 DONE 0.1s

#36 [builder  8/13] COPY packages/remark-drawio-plugin packages/remark-drawio-plugin
#36 sha256:42158dda74066c7eacaec3da4c12e6ead5f2433cf5ae375828785b25aea4f3ba
#36 DONE 0.0s

#37 [builder  9/13] COPY packages/remark-growi-plugin packages/remark-growi-plugin
#37 sha256:1b2e79bd953fda217b43452479513857397d3e0643098bc00fff10f898297f4f
#37 DONE 0.0s

#38 [builder 10/13] COPY packages/remark-lsx packages/remark-lsx
#38 sha256:bbcda6b4bea6ebca2d4dbbe40e7d63e7ca99be70776fddc041fc899adf75e974
#38 DONE 0.1s

#39 [builder 11/13] COPY packages/hackmd packages/hackmd
#39 sha256:f1d668b493e9f4033b358948ef8045dc7aef3421503d196af229be4238cc6e39
#39 DONE 0.1s

#40 [builder 12/13] RUN yarn lerna run build
#40 sha256:58597474ff40d7537ce88d02bbe1d5d53efb2b78cc6521121e03cb4393f36218
#40 1.803 yarn run v1.22.19
#40 2.140 $ /opt/node_modules/.bin/lerna run build
#40 3.966 lerna notice cli v4.0.0
#40 4.324 lerna info Executing command in 9 packages: "yarn run build"
#40 25.25 lerna info run Ran npm script 'build' in '@growi/codemirror-textlint' in 20.9s:
#40 25.25 $ yarn tsc && tsc-alias -p tsconfig.build.json
#40 25.25 $ tsc -p tsconfig.build.json
#40 25.25 Info: === tsc-alias starting ===
#40 25.25 Info: 0 files were affected!
#40 25.75 lerna info run Ran npm script 'build' in '@growi/remark-drawio-plugin' in 21.4s:
#40 25.75 $ yarn tsc && tsc-alias -p tsconfig.build.json
#40 25.75 $ tsc -p tsconfig.build.json
#40 25.75 Info: === tsc-alias starting ===
#40 25.75 Info: 0 files were affected!
#40 27.51 lerna info run Ran npm script 'build' in '@growi/core' in 23.1s:
#40 27.52 $ run-p build:*
#40 27.52 $ tsc -p tsconfig.build.cjs.json && tsc-alias -p tsconfig.build.cjs.json
#40 27.52 $ tsc -p tsconfig.build.esm.json && tsc-alias -p tsconfig.build.esm.json
#40 27.52 Info: === tsc-alias starting ===
#40 27.52 Info: 0 files were affected!
#40 27.52 Info: === tsc-alias starting ===
#40 27.52 Info: 0 files were affected!
#40 51.74 $ yarn tsc && tsc-alias -p tsconfig.build.json
#40 51.74 $ tsc -p tsconfig.build.json
#40 51.74 Info: === tsc-alias starting ===
#40 51.74 Info: 0 files were affected!
#40 51.74 lerna info run Ran npm script 'build' in '@growi/remark-growi-plugin' in 26.5s:
#40 54.15 lerna info run Ran npm script 'build' in '@growi/hackmd' in 49.8s:
#40 54.15 $ vite build && npx -y shx cp ./src/index.js ./dist
#40 54.15 vite v3.1.7 building for production...
#40 54.15 transforming...
#40 54.15 ✓ 31 modules transformed.
#40 54.15 rendering chunks...
#40 54.15 dist/styles.js    0.48 KiB / gzip: 0.29 KiB
#40 54.15 dist/agent.js     7.44 KiB / gzip: 2.79 KiB
#40 54.15 dist/styles.css   0.27 KiB / gzip: 0.20 KiB
#40 54.17 lerna info run Ran npm script 'build' in '@growi/slack' in 28.4s:
#40 54.17 $ yarn tsc && tsc-alias -p tsconfig.build.json
#40 54.17 $ tsc -p tsconfig.build.json
#40 54.17 Info: === tsc-alias starting ===
#40 54.17 Info: 0 files were affected!
#40 55.00 lerna info run Ran npm script 'build' in '@growi/ui' in 27.5s:
#40 55.00 $ run-p build:*
#40 55.00 $ tsc -p tsconfig.build.esm.json && tsc-alias -p tsconfig.build.esm.json
#40 55.00 $ tsc -p tsconfig.build.cjs.json && tsc-alias -p tsconfig.build.cjs.json
#40 55.00 Info: === tsc-alias starting ===
#40 55.00 Info: 0 files were affected!
#40 55.00 Info: === tsc-alias starting ===
#40 55.00 Info: 0 files were affected!
#40 64.82 lerna info run Ran npm script 'build' in '@growi/remark-lsx' in 9.8s:
#40 64.82 $ run-p build:*
#40 64.82 $ tsc -p tsconfig.build.cjs.json && tsc-alias -p tsconfig.build.cjs.json
#40 64.82 $ tsc -p tsconfig.build.esm.json && tsc-alias -p tsconfig.build.esm.json
#40 64.82 Info: === tsc-alias starting ===
#40 64.82 Info: 0 files were affected!
#40 64.82 Info: === tsc-alias starting ===
#40 64.82 Info: 0 files were affected!
#40 2465.0 lerna info run Ran npm script 'build' in '@growi/app' in 2400.2s:
#40 2465.0 $ yarn cross-env NODE_ENV=production run-p clean resources:*
#40 2465.0 $ /opt/node_modules/.bin/cross-env NODE_ENV=production run-p clean 'resources:*'
#40 2465.0 $ true
#40 2465.0 $ yarn lerna run build --scope=@growi/hackmd
#40 2465.0 $ npx -y shx rm -rf dist transpiled
#40 2465.0 $ /opt/node_modules/.bin/lerna run build --scope=@growi/hackmd
#40 2465.0 $ vite build && npx -y shx cp ./src/index.js ./dist
#40 2465.0 vite v3.1.7 building for production...
#40 2465.0 transforming...
#40 2465.0 ✓ 31 modules transformed.
#40 2465.0 rendering chunks...
#40 2465.0 dist/styles.js    0.48 KiB / gzip: 0.29 KiB
#40 2465.0 dist/styles.css   0.27 KiB / gzip: 0.20 KiB
#40 2465.0 dist/agent.js     7.44 KiB / gzip: 2.79 KiB
#40 2465.0 $ run-p build:*
#40 2465.0 $ tsc -p tsconfig.build.next.config.json
#40 2465.0 $ yarn cross-env NODE_ENV=production tsc -p tsconfig.build.server.json && tsc-alias -p tsconfig.build.server-tsc-alias.json
#40 2465.0 $ /opt/node_modules/.bin/cross-env NODE_ENV=production tsc -p tsconfig.build.server.json
#40 2465.0 $ yarn next build
#40 2465.0 $ /opt/node_modules/.bin/next build
#40 2465.0 info  - Loaded env from /opt/packages/app/.env.production
#40 2465.0 info  - SWC minify release candidate enabled. https://nextjs.link/swcmin
#40 2465.0 info  - Skipping linting
#40 2465.0 info  - Checking validity of types...
#40 2465.0 info  - Creating an optimized production build...
#40 2465.0 info  - Using tsconfig file: tsconfig.build.client.json
#40 2465.0 Info: === tsc-alias starting ===
#40 2465.0 Info: 664 files were affected!
#40 2465.0 $ npx -y shx echo "Listing files under transpiled" && npx -y shx ls transpiled && npx -y shx mv transpiled/src dist && npx -y shx cp -r transpiled/config/* config && npx -y shx cp -r src/server/views dist/server/ && npx -y shx rm -rf transpiled
#40 2465.0 Listing files under transpiled
#40 2465.0 config
#40 2465.0 package.json
#40 2465.0 resource
#40 2465.0 src
#40 2465.0 tsconfig.build.server.tsbuildinfo
#40 2465.0 Webpack Bundle Analyzer saved report to /opt/packages/app/.next/server/analyze/server.html
#40 2465.0 
#40 2465.0 No bundles were parsed. Analyzer will show only original module sizes from stats file.
#40 2465.0 
#40 2465.0 Webpack Bundle Analyzer saved report to /opt/packages/app/.next/analyze/server.html
#40 2465.0 Webpack Bundle Analyzer saved report to /opt/packages/app/.next/analyze/client.html
#40 2465.0 info  - Compiled successfully
#40 2465.0 info  - Collecting page data...
#40 2465.0 Route (pages)                                          Size     First Load JS
#40 2465.0 ┌   /_app                                              0 B             232 kB
#40 2465.0 ├ λ /_private-legacy-pages                             1.46 kB         252 kB
#40 2465.0 ├ λ /_search                                           33.3 kB         376 kB
#40 2465.0 ├   └ css/1483296c3ee99888.css                         761 B
#40 2465.0 ├ λ /[[...path]]                                       15.7 kB         735 kB
#40 2465.0 ├   └ css/cd910040a20a63b8.css                         4.36 kB
#40 2465.0 ├ λ /404                                               397 B           232 kB
#40 2465.0 ├ λ /admin                                             7.84 kB         281 kB
#40 2465.0 ├ λ /admin/[...path]                                   1.83 kB         244 kB
#40 2465.0 ├ λ /admin/app                                         1.01 kB         249 kB
#40 2465.0 ├ λ /admin/audit-log                                   1.67 kB         236 kB
#40 2465.0 ├ λ /admin/customize                                   7.99 kB         282 kB
#40 2465.0 ├ λ /admin/export                                      758 B           249 kB
#40 2465.0 ├ λ /admin/global-notification/[globalNotificationId]  5.65 kB         282 kB
#40 2465.0 ├ λ /admin/global-notification/new                     3.07 kB         248 kB
#40 2465.0 ├ λ /admin/importer                                    8.14 kB         282 kB
#40 2465.0 ├ λ /admin/markdown                                    5.39 kB         248 kB
#40 2465.0 ├ λ /admin/notification                                3.09 kB         248 kB
#40 2465.0 ├ λ /admin/search                                      1.65 kB         236 kB
#40 2465.0 ├ λ /admin/security                                    12.1 kB         286 kB
#40 2465.0 ├ λ /admin/slack-integration                           1.65 kB         236 kB
#40 2465.0 ├ λ /admin/slack-integration-legacy                    5.08 kB         247 kB
#40 2465.0 ├ λ /admin/user-group-detail/[userGroupId]             2.68 kB         245 kB
#40 2465.0 ├ λ /admin/user-groups                                 1.63 kB         236 kB
#40 2465.0 ├ λ /admin/users                                       6.32 kB         249 kB
#40 2465.0 ├ λ /admin/users/external-accounts                     5.08 kB         247 kB
#40 2465.0 ├ λ /forgot-password                                   617 B           235 kB
#40 2465.0 ├ λ /forgot-password-errors                            2.09 kB         236 kB
#40 2465.0 ├ λ /installer                                         7.14 kB         282 kB
#40 2465.0 ├ λ /invited                                           2.83 kB         239 kB
#40 2465.0 ├ λ /login                                             4.39 kB         252 kB
#40 2465.0 ├ λ /maintenance                                       5.07 kB         276 kB
#40 2465.0 ├ λ /me/[[...path]]                                    5.66 kB         308 kB
#40 2465.0 ├ λ /reset-password                                    663 B           235 kB
#40 2465.0 ├ λ /share/[[...path]]                                 6.29 kB         713 kB
#40 2465.0 ├   └ css/d138a4b36d77d6c7.css                         2.89 kB
#40 2465.0 ├ λ /tags                                              5.74 kB         308 kB
#40 2465.0 ├ λ /trash                                             8.69 kB         336 kB
#40 2465.0 ├   └ css/9f15e2a5cc23470c.css                         2.75 kB
#40 2465.0 └ λ /user-activation                                   4.05 kB         283 kB
#40 2465.0 + First Load JS shared by all                          321 kB
#40 2465.0   ├ chunks/framework-ce93025758a0b7c0.js               45.7 kB
#40 2465.0   ├ chunks/main-03952ef8fae2123e.js                    31.8 kB
#40 2465.0   ├ chunks/pages/_app-71a9f63b5ad12715.js              141 kB
#40 2465.0   ├ chunks/webpack-ee3cb0b3ad3ab4cb.js                 13 kB
#40 2465.0   └ css/94aad47c6a3260e6.css                           89.3 kB
#40 2465.0 
#40 2465.0 λ  (Server)  server-side renders at runtime (uses getInitialProps or getServerSideProps)
#40 2465.0 
#40 2465.0 lerna success run Ran npm script 'build' in 9 packages in 2460.7s:
#40 2465.0 lerna success - @growi/app
#40 2465.0 lerna success - @growi/codemirror-textlint
#40 2465.0 lerna success - @growi/core
#40 2465.0 lerna success - @growi/hackmd
#40 2465.0 lerna success - @growi/remark-drawio-plugin
#40 2465.0 lerna success - @growi/remark-growi-plugin
#40 2465.0 lerna success - @growi/remark-lsx
#40 2465.0 lerna success - @growi/slack
#40 2465.0 lerna success - @growi/ui
#40 2465.2 Done in 2463.41s.
#40 DONE 2465.6s

#41 [builder 13/13] RUN tar -cf packages.tar   package.json   packages/app/.next   packages/app/config   packages/app/public   packages/app/resource   packages/app/tmp   packages/app/.env.production*   packages/*/package.json   packages/*/dist
#41 sha256:1d5c5b6609b7c286cb3b11c30b5897bf947e4e39deae1416bc931109410ef31b
#41 DONE 1880.5s

#24 [deps-resolver-prod 3/3] RUN tar -cf node_modules.tar   node_modules   packages/*/node_modules
#24 sha256:82469afab3b3a647846f942578a021641a26a86f48b8022efb2ad814d80e77b2
#24 CACHED

#22 [deps-resolver-prod 1/3] RUN rm -rf packages/slackbot-proxy
#22 sha256:dbd5b2f3f01b472335554cdf5ba92ebda5f266bb977f5f683f94739303d5d020
#22 CACHED

#11 [stage-6  2/10] RUN set -eux; 	apt-get update; 	apt-get install -y gosu; 	rm -rf /var/lib/apt/lists/*; 	gosu nobody true
#11 sha256:395b4ab60950dac6b61c52702d30b0478392a33af332d34874ef8e6e076e42ec
#11 CACHED

#23 [deps-resolver-prod 2/3] RUN npx -y lerna bootstrap -- --production
#23 sha256:ded7f5f6b979c8e5f8053ef72abab5d84647732e08543e2a977264e8784c8552
#23 CACHED

#25 [stage-6  3/10] COPY --from=deps-resolver-prod --chown=node:node   /opt/node_modules.tar /opt/growi/
#25 sha256:5a0cd504491ea3a571a829ab06cd0e6355ed8efb07252a553a34fb38d31f68f3
#25 CACHED

#42 [stage-6  4/10] COPY --from=builder --chown=node:node   /opt/packages.tar /opt/growi/
#42 sha256:b01091684e9a8cd8f35372bde544a78175eb7890fe53184bff6eaa5a93689686
#42 DONE 23.8s

#43 [stage-6  5/10] WORKDIR /opt/growi
#43 sha256:0fcea6af00055fe12135811dcf2adaa09ad90ebbebbedcaca9c71a83ecf0f501
#43 DONE 0.1s

#44 [stage-6  6/10] RUN tar -xf node_modules.tar
#44 sha256:4e6626bb9356d223f9d689789dbedb489c0f042b33e261dc48f395cdeb2f9129
#44 DONE 15.0s

#45 [stage-6  7/10] RUN tar -xf packages.tar
#45 sha256:733cd2eca16ee5b293163a114785826db83e78b404922d75e5cebf33869b27fa
#45 DONE 24.4s

#46 [stage-6  8/10] RUN rm node_modules.tar packages.tar
#46 sha256:19718d6a0deb4f4405eb4ea9bc03798d039ca27f1f22ea3adb2bf7981aef102a
#46 DONE 1.8s

#47 [stage-6  9/10] COPY --chown=node:node --chmod=700 packages/app/docker/docker-entrypoint.sh /
#47 sha256:f716e905636f16178bb89576a653a4587716f6790b95a46989ba269e1f3cd4ed
#47 DONE 0.2s

#48 [stage-6 10/10] WORKDIR /opt/growi/packages/app
#48 sha256:21e5bd293ce0b360dbac50d36f708b29ab13a42756bf96dac672dc78dc71164b
#48 DONE 0.1s

#49 exporting to image
#49 sha256:e8c613e07b0b7ff33893b694f7759a10d42e180f2b4dc349fb57dc6b71dcab00
#49 exporting layers
#49 exporting layers 150.3s done
#49 writing image sha256:b85f259ec8318ea4d4893e960955cc063cd3abf9ef23a468cdadb35fa3084b1e
#49 writing image sha256:b85f259ec8318ea4d4893e960955cc063cd3abf9ef23a468cdadb35fa3084b1e 0.0s done
#49 naming to docker.io/library/rcgrowi done
#49 DONE 150.4s

Use 'docker scan' to run Snyk tests against images to find vulnerabilities and learn how to fix them
